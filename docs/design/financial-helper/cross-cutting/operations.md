# 运维与监控

**日期：** 2026-02-19
**作者：** financial_helper 团队

---

## 13. 运维与监控

### 13.1 监控指标

| 类别 | 指标 |
|------|------|
| 系统 | CPU、内存、磁盘、网络 |
| API | QPS、响应时间、错误率 |
| 数据 | 抓取成功率、数据延迟、数据质量 |
| LLM | 调用次数、Token 消耗、成功率、平均耗时 |
| 任务 | 队列长度、执行成功率、执行时间 |

### 13.2 健康检查

- **应用健康检查**：`/health` 端点
- **数据库健康检查**：连接性 + 简单查询
- **外部服务健康检查**：Tushare、LLM API 可用性
- **容器健康检查**：Docker Compose healthcheck

### 13.3 日志与可观测性

- **结构化日志**：structlog + JSON 格式
- **链路追踪**：OpenTelemetry（可选）
- **指标采集**：Prometheus + Grafana

### 13.4 备份与恢复

- **数据库备份**：
  - PostgreSQL：每日全量 + 增量 WAL
  - InfluxDB：定时快照
  - Neo4j：定时备份
- **备份策略**：
  - 本地保留 7 天
  - 异地保留 30 天
- **恢复演练**：定期演练恢复流程
